<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='utf-8'>
  <title>NProgress: slim progress bars in JavaScript</title>
  <link href='support/style.css' rel='stylesheet' />
  <link href='support/no-screen-flicker-in-chrome.css' rel='stylesheet' />
  <link href='nprogress.css' rel='stylesheet' />

  <meta name="viewport" content="width=device-width">
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,400,700,400italic' rel='stylesheet' type='text/css'>

  <script src='nprogress.js'></script>
</head>

<body style='display: none'>
  <header class='page-header'>
    <div class='hcenter'>
      <span class='nprogress-logo fade out'></span>
      <h1>NProgress<i>.js</i></h1>
      <p class='fade out brief big'>A nanoscopic progress bar. Featuring realistic
      trickle animations to convince your users that something is happening!</p>
    </div>
  </header>

  <div class='contents fade out'>
    <hr />
    
    <div class='controls'>
      <p>
        <button class='button play' id='b-0' onclick='NProgress.start("Here we go");'></button>
        <i>NProgress</i><b>.start()</b>
        &mdash;
        shows the progress bar
      </p>
      <p>
        <button class='button play' id='b-40' onclick='NProgress.set(0.4, "40% no less");'></button>
        <i>NProgress</i><b>.set(0.4)</b>
        &mdash;
        sets a percentage
      </p>
      <p>
        <button class='button play' id='b-inc' onclick='NProgress.inc("default", "a little more");'></button>
        <i>NProgress</i><b>.inc()</b>
        &mdash;
        increments by a little
      </p>
      <p>
        <button class='button play' id='b-err' onclick='NProgress.signal();'></button>
        <i>NProgress</i><b>.signal()</b>
        &mdash;
        signal an error in the user code
      </p>
      <p>
        <button class='button play' id='b-100' onclick='NProgress.done();'></button>
        <i>NProgress</i><b>.done()</b>
        &mdash;
        completes the progress
      </p>
    </div>
    <div class='actions'>
      <a href='https://github.com/rstacruz/nprogress' class='button primary big'>
        Download
        v<span class='version'></span>
      </a>
      <p class='brief'>Perfect for Turbolinks, Pjax, and other Ajax-heavy apps.</p>
    </div>
    <div class='hr-rule'></div>
    <div class='share-buttons'>
      <iframe src="http://ghbtns.com/github-btn.html?user=rstacruz&repo=nprogress&type=watch&count=true"
          allowtransparency="true" frameborder="0" scrolling="0" width="100" height="20"></iframe>
      <iframe src="http://ghbtns.com/github-btn.html?user=rstacruz&type=follow&count=true"
          allowtransparency="true" frameborder="0" scrolling="0" width="175" height="20"></iframe>
    </div>
  </div>

  <script>
    var body = document.getElementsByTagName('body')[0];
    body.style.display = 'block'; // $('body').show();
    var version_el = body.getElementsByClassName('version');
    for (var i = version_el.length; i-- > 0; ) {
      version_el[i].innerHTML = NProgress.version; // $('.version').text(NProgress.version);
    }
    NProgress.start("Hello World...");

    NProgress.settings.onDoneBegin.addEventListener(slow_fade_all_ends_all);
    NProgress.settings.onDone.addEventListener(prep_for_interactive_demo);
	
	// The demo tick() helper function checks this list for when to change the NProgress
	// message displayed on screen ()and maybe do a few more things, e.g. additional custom UI
	// update work). The swithcing points ('markers') are sorted from last to first to
	// simplify the `tick()` code.
    var boot_time_markers = [
      // NProgress.inc() will never arrive at 'done' all by itself as it won't push the .status beyond the 0.994 mark:
      {
        status: 0.99,
        action: function () {
          NProgress.done(false, "Initial example animation completed");

          // slow_fade_all_ends_all(); <-- executed via NProgress.settings.onDoneBegin instead
        }
      },
      {
        status: 0.7,
        action: function () {
          NProgress.inc(0, "While style changes are possible too!");
        }
      },
      {
        status: 0.25,
        action: function () {
          NProgress.inc(0, "We can change the progress message on the fly!");
        }
      }
    ];
    var markers = boot_time_markers;

    function tick() {
      for (var i = 0, len = markers.length; i < len; i++) {
        var m = markers[i];
        if (!m.done && NProgress.status >= m.status) {
          m.done = true;
          m.action();
          break;
        }
      }
    }

    NProgress.settings.onTrickle.addEventListener(tick);
	  
	// Three optional ways to manipulate the visual NProgress trickle update rate
	// and speed it up for this demo:
	switch (0) {
	case 1:
      NProgress.settings.trickleSpeed = 200;
      NProgress.settings.trickleRate = 0.15;
	  break;
	  
    case 2:
	  NProgress.settings.trickleRate = 0.25;
	  break;
	  
    case 3:
	  NProgress.settings.trickleSpeed = 50;
	  break;
	}
	
    function slow_fade_all_ends_all() {
      function slow_fade_one(el, i) {
        setTimeout(function() {
          NProgress.Internals.removeClass(el, 'out');
        }, i * 500);
      }
      var fade_el = body.getElementsByClassName('fade');
      for (var i = fade_el.length; i-- > 0; ) {
        slow_fade_one(fade_el[i], i);
      }
    }

    // This function is invoked AFTER the previous NProgress instance has been removed from the DOM, 
    // hence we're perfectly safe when switching the NProgress 'parent' DOM node.
    // 
    // Here we switch to a DOM node that's not 'body' itself to showcase the progressbar interactively.
    function prep_for_interactive_demo() {
      NProgress.configure({
        parent: '.page-header'
      });

      // And remove all previously registered onTrickle registered callbacks:
      NProgress.settings.onTrickle.removeEventListener();
      // Set up the new onTrickle handler:
      markers = in_page_demo_markers;
      NProgress.settings.onTrickle.addEventListener(tick);
      // > The above bit of `onTrickle` related demo code can be simplified to only
      // > one line of code where the `markers[]` array is switched over to point at the 
      // > `in_page_demo_markers[]` in our particular situation.
      // > 
      // > We wanted to show how to clean out the registered handlers and set up a new set
      // > here...
    }
  </script>
</body>
</html>
